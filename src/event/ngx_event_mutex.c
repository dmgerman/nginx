begin_unit|revision:1.0.0;language:C;cregit-version:0.0.1
begin_expr_stmt
name|spinlock_max
name|depend
name|on
name|CPU
name|number
name|and
name|mutex
name|type
operator|.
expr|1
name|CPU
literal|1
name|ngx_malloc_mutex
literal|1000
condition|?
name|int
name|ngx_event_mutex_trylock
argument_list|(
argument|ngx_mutex_t *mtx
argument_list|)
block|{
for|for
control|(
name|i
operator|=
name|mtx
operator|->
name|spinlock_max
init|;
name|i
condition|;
name|i
operator|--
control|)
if|if
condition|(
name|trylock
argument_list|(
name|mtx
operator|->
name|lock
argument_list|)
condition|)
return|return
literal|1
return|;
end_expr_stmt

begin_return
return|return
literal|0
return|;
end_return

unit|}
end_unit


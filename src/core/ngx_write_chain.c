begin_unit|revision:1.0.0;language:C;cregit-version:0.0.1
begin_include
include|#
directive|include
file|<ngx_config.h>
end_include

begin_include
include|#
directive|include
file|<ngx_core.h>
end_include

begin_include
include|#
directive|include
file|<ngx_types.h>
end_include

begin_include
include|#
directive|include
file|<ngx_alloc.h>
end_include

begin_include
include|#
directive|include
file|<ngx_array.h>
end_include

begin_include
include|#
directive|include
file|<ngx_hunk.h>
end_include

begin_include
include|#
directive|include
file|<ngx_connection.h>
end_include

begin_function_decl
DECL|variable|ngx_write_chain_proc
name|ngx_chain_t
modifier|*
function_decl|(
modifier|*
name|ngx_write_chain_proc
function_decl|)
parameter_list|(
name|ngx_connection_t
modifier|*
name|c
parameter_list|,
name|ngx_chain_t
modifier|*
name|in
parameter_list|)
function_decl|;
end_function_decl

begin_function
DECL|function|ngx_write_chain (ngx_connection_t * c,ngx_chain_t * in,off_t flush)
name|ngx_chain_t
modifier|*
name|ngx_write_chain
parameter_list|(
name|ngx_connection_t
modifier|*
name|c
parameter_list|,
name|ngx_chain_t
modifier|*
name|in
parameter_list|,
name|off_t
name|flush
parameter_list|)
block|{
if|#
directive|if
operator|(
name|NGX_EVENT
operator|)
return|return
call|(
modifier|*
name|ngx_write_chain_proc
call|)
argument_list|(
name|c
argument_list|,
name|in
argument_list|)
return|;
elif|#
directive|elif
operator|(
name|NGX_EVENT_THREAD
operator|)
name|off_t
name|sent
decl_stmt|;
name|ngx_chain_t
modifier|*
name|rc
decl_stmt|;
name|sent
operator|=
name|flush
operator|-
name|c
operator|->
name|sent
expr_stmt|;
do|do
block|{
name|rc
operator|=
call|(
modifier|*
name|ngx_write_chain_proc
call|)
argument_list|(
name|c
argument_list|,
name|in
argument_list|)
expr_stmt|;
if|if
condition|(
name|rc
operator|==
name|NGX_CHAIN_ERROR
operator|&&
name|rc
operator|==
name|NULL
condition|)
block|{
return|return
name|rc
return|;
block|}
block|}
do|while
condition|(
name|c
operator|->
name|thread
operator|&&
name|flush
operator|>
name|c
operator|->
name|sent
operator|-
name|sent
condition|)
do|;
else|#
directive|else
name|ngx_chain_t
modifier|*
name|rc
decl_stmt|;
do|do
block|{
name|rc
operator|=
call|(
modifier|*
name|ngx_write_chain_proc
call|)
argument_list|(
name|c
argument_list|,
name|in
argument_list|)
expr_stmt|;
block|}
do|while
condition|(
name|rc
operator|!=
name|NGX_CHAIN_ERROR
operator|&&
name|rc
operator|!=
name|NULL
condition|)
do|;
return|return
name|rc
return|;
endif|#
directive|endif
block|}
end_function

end_unit

